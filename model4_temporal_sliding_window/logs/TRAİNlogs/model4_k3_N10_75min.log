17:59:20 | Device: cuda
17:59:20 | Config: pred_min=75, N=10, k=3, hidden=128
17:59:20 | Training: epochs=300, lr=0.001, batch=64, patience=50
17:59:20 | ============================================================
17:59:20 | [1/6] Loading cache...
18:00:10 | Cache loaded: 2806 matches
18:00:10 | [2/6] Processing matches (temporal windows)...
18:11:00 | Processed 2806/2806 matches (0 failed)
18:11:00 | Class distribution: Home=1195 (42.6%) Away=924 (32.9%) Draw=687 (24.5%)
18:11:00 | [3/6] Splitting data (stratified, BEFORE scaling)...
18:11:00 | Split: Train=1683 Val=561 Test=562
18:11:00 | [4/6] Fitting scalers on TRAINING data only...
18:11:00 | Scalers fitted: cum_node, int_node, cum_ingame, int_ingame
18:11:03 | Scalers applied to train/val/test sets
18:11:03 | [5/6] Creating DataLoaders...
18:11:03 | [6/6] Creating model...
18:11:04 | Model parameters: 223,619
18:11:04 | Class weights: [0.7824267745018005, 1.012635350227356, 1.3616504669189453]
18:11:04 | ============================================================
18:11:04 | TRAINING START
18:11:04 | ============================================================
18:11:07 | Epoch    1 | Loss: 1.1697 | Train: 0.6393 | Val: 0.6185 | Best: 0.6185 | LR: 0.000990 | Pred: H=258 A=303 D=0
18:11:30 | Epoch   10 | Loss: 0.4931 | Train: 0.8318 | Val: 0.7772 | Best: 0.7825 | LR: 0.000904 | Pred: H=227 A=159 D=175
18:11:53 | Epoch   20 | Loss: 0.4648 | Train: 0.8532 | Val: 0.7807 | Best: 0.7843 | LR: 0.000818 | Pred: H=223 A=163 D=175
18:12:16 | Epoch   30 | Loss: 0.4293 | Train: 0.8586 | Val: 0.7879 | Best: 0.7879 | LR: 0.000740 | Pred: H=228 A=171 D=162
18:12:39 | Epoch   40 | Loss: 0.4198 | Train: 0.8580 | Val: 0.7843 | Best: 0.7897 | LR: 0.000669 | Pred: H=238 A=160 D=163
18:13:04 | Epoch   50 | Loss: 0.4044 | Train: 0.8610 | Val: 0.7611 | Best: 0.7932 | LR: 0.000605 | Pred: H=204 A=180 D=177
18:13:30 | Epoch   60 | Loss: 0.3829 | Train: 0.8723 | Val: 0.7790 | Best: 0.7932 | LR: 0.000547 | Pred: H=227 A=176 D=158
18:14:01 | Epoch   70 | Loss: 0.3819 | Train: 0.8699 | Val: 0.7879 | Best: 0.7932 | LR: 0.000495 | Pred: H=239 A=169 D=153
18:14:33 | Epoch   80 | Loss: 0.3803 | Train: 0.8740 | Val: 0.7540 | Best: 0.7932 | LR: 0.000448 | Pred: H=215 A=169 D=177
18:15:04 | Epoch   90 | Loss: 0.3769 | Train: 0.8818 | Val: 0.7790 | Best: 0.7932 | LR: 0.000405 | Pred: H=233 A=184 D=144
18:15:29 | Early stopping at epoch 98
18:15:29 | ============================================================
18:15:29 | FINAL EVALUATION
18:15:29 | ============================================================
18:15:29 | Test Accuracy: 0.7936
18:15:29 | Best Val Accuracy: 0.7932
18:15:29 |   Home Win: 201/239 = 84.1%
18:15:29 |   Away Win: 145/185 = 78.4%
18:15:29 |   Draw: 100/138 = 72.5%
18:15:29 | Training time: 16.16 minutes
18:15:29 | Model saved to models/temporal_predictor_k3_N10_75min.pt
18:15:29 | Scalers saved to models/scalers_k3_N10_75min.pkl
18:15:30 | Test data saved to models/test_data_k3_N10_75min.pt
18:15:30 | Config saved to models/config_k3_N10_75min.pkl
